<html lang="en"><head>
    <title>Code coverage report for node-npmtest-nock/nock/lib/common.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-nock">npmtest-nock (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-nock/nock/lib/common.js</span></h1>
    <h2>
        
        Statements: <span class="metric">39.77% <small>(68 / 171)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">9.78% <small>(9 / 92)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">25% <small>(7 / 28)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">40.48% <small>(68 / 168)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> » <a href="index.html">node-npmtest-nock/nock/lib/</a> » common.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tbody><tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">16</span>
<span class="cline-any cline-yes">16</span>
<span class="cline-any cline-yes">16</span>
<span class="cline-any cline-yes">8</span>
<span class="cline-any cline-yes">8</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16</span>
<span class="cline-any cline-yes">16</span>
<span class="cline-any cline-yes">16</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16</span>
<span class="cline-any cline-yes">32</span>
<span class="cline-any cline-yes">32</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict';
&nbsp;
var _ = require('lodash');
var debug = require('debug')('nock.common');
&nbsp;
/**
 * Normalizes the request options so that it always has `host` property.
 *
 * @param  {Object} options - a parsed options object of the request
 */
var normalizeRequestOptions = function(options) {
  options.proto = options.proto || (<span class="branch-1 cbranch-no" title="branch not covered">options._https_ ? 'https': 'http')</span>;
  options.port = options.port || (<span class="branch-1 cbranch-no" title="branch not covered">(options.proto === 'http') ? 80 : 443)</span>;
  if (options.host) {
    debug('options.host:', options.host);
    <span class="missing-if-branch" title="if path not taken">I</span>if (! options.hostname) {
<span class="cstat-no" title="statement not covered">      if (options.host.split(':').length == 2) {</span>
<span class="cstat-no" title="statement not covered">        options.hostname = options.host.split(':')[0];</span>
      } else {
<span class="cstat-no" title="statement not covered">        options.hostname = options.host;</span>
      }
    }
  }
  debug('options.hostname in the end: %j', options.hostname);
  options.host = (options.hostname || <span class="branch-1 cbranch-no" title="branch not covered">'localhost')</span> + ':' + options.port;
  debug('options.host in the end: %j', options.host);
&nbsp;
  /// lowercase host names
  ['hostname', 'host'].forEach(function(attr) {
    <span class="missing-if-branch" title="else path not taken">E</span>if (options[attr]) {
      options[attr] = options[attr].toLowerCase();
    }
  });
&nbsp;
  return options;
};
&nbsp;
/**
 * Returns true if the data contained in buffer is binary which in this case means
 * that it cannot be reconstructed from its utf8 representation.
 *
 * @param  {Object} buffer - a Buffer object
 */
var isBinaryBuffer = <span class="fstat-no" title="function not covered">function(buffer) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  if(!Buffer.isBuffer(buffer)) {</span>
<span class="cstat-no" title="statement not covered">    return false;</span>
  }
&nbsp;
  //  Test if the buffer can be reconstructed verbatim from its utf8 encoding.
<span class="cstat-no" title="statement not covered">  var utfEncodedBuffer = buffer.toString('utf8');</span>
<span class="cstat-no" title="statement not covered">  var reconstructedBuffer = new Buffer(utfEncodedBuffer, 'utf8');</span>
<span class="cstat-no" title="statement not covered">  var compareBuffers = <span class="fstat-no" title="function not covered">function(lhs, rhs) {</span></span>
<span class="cstat-no" title="statement not covered">    if(lhs.length !== rhs.length) {</span>
<span class="cstat-no" title="statement not covered">      return false;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered">    for(var i = 0; i &lt; lhs.length; ++i) {</span>
<span class="cstat-no" title="statement not covered">      if(lhs[i] !== rhs[i]) {</span>
<span class="cstat-no" title="statement not covered">        return false;</span>
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered">    return true;</span>
  };
&nbsp;
  //  If the buffers are *not* equal then this is a "binary buffer"
  //  meaning that it cannot be faitfully represented in utf8.
<span class="cstat-no" title="statement not covered">  return !compareBuffers(buffer, reconstructedBuffer);</span>
&nbsp;
};
&nbsp;
/**
 * If the chunks are Buffer objects then it returns a single Buffer object with the data from all the chunks.
 * If the chunks are strings then it returns a single string value with data from all the chunks.
 *
 * @param  {Array} chunks - an array of Buffer objects or strings
 */
var mergeChunks = <span class="fstat-no" title="function not covered">function(chunks) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  if(_.isEmpty(chunks)) {</span>
<span class="cstat-no" title="statement not covered">    return new Buffer(0);</span>
  }
&nbsp;
  //  We assume that all chunks are Buffer objects if the first is buffer object.
<span class="cstat-no" title="statement not covered">  var areBuffers = Buffer.isBuffer(_.first(chunks));</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  if(!areBuffers) {</span>
    //  When the chunks are not buffers we assume that they are strings.
<span class="cstat-no" title="statement not covered">    return chunks.join('');</span>
  }
&nbsp;
  //  Merge all the buffers into a single Buffer object.
<span class="cstat-no" title="statement not covered">  return Buffer.concat(chunks);</span>
&nbsp;
};
&nbsp;
//  Array where all information about all the overridden requests are held.
var requestOverride = [];
&nbsp;
/**
 * Overrides the current `request` function of `http` and `https` modules with
 * our own version which intercepts issues HTTP/HTTPS requests and forwards them
 * to the given `newRequest` function.
 *
 * @param  {Function} newRequest - a function handling requests; it accepts four arguments:
 *   - proto - a string with the overridden module's protocol name (either `http` or `https`)
 *   - overriddenRequest - the overridden module's request function already bound to module's object
 *   - options - the options of the issued request
 *   - callback - the callback of the issued request
 */
var overrideRequests = function(newRequest) {
  debug('overriding requests');
&nbsp;
  ['http', 'https'].forEach(function(proto) {
    debug('- overriding request for', proto);
&nbsp;
    var moduleName = proto, // 1 to 1 match of protocol and module is fortunate :)
        module = {
          http: require('http'),
          https: require('https')
        }[moduleName],
        overriddenRequest = module.request;
&nbsp;
    <span class="missing-if-branch" title="if path not taken">I</span>if(requestOverride[moduleName]) {
<span class="cstat-no" title="statement not covered">      throw new Error('Module\'s request already overridden for ' + moduleName + ' protocol.');</span>
    }
&nbsp;
    //  Store the properties of the overridden request so that it can be restored later on.
    requestOverride[moduleName] = {
      module: module,
      request: overriddenRequest
    };
&nbsp;
    module.request = function(options, callback) {
      // debug('request options:', options);
      return newRequest(proto, overriddenRequest.bind(module), options, callback);
    };
&nbsp;
    debug('- overridden request for', proto);
  });
};
&nbsp;
/**
 * Restores `request` function of `http` and `https` modules to values they
 * held before they were overridden by us.
 */
var restoreOverriddenRequests = function() {
  debug('restoring requests');
&nbsp;
  //  Restore any overridden requests.
  _(requestOverride).keys().each(function(proto) {
    debug('- restoring request for', proto);
&nbsp;
    var override = requestOverride[proto];
    <span class="missing-if-branch" title="else path not taken">E</span>if(override) {
      override.module.request = override.request;
      debug('- restored request for', proto);
    }
  });
  requestOverride = [];
};
&nbsp;
/**
 * Get high level information about request as string
 * @param  {Object} options
 * @param  {string} options.method
 * @param  {string} options.port
 * @param  {string} options.proto
 * @param  {string} options.hostname
 * @param  {string} options.path
 * @param  {Object} options.headers
 * @param  {string|object} body
 * @return {string}
 */
<span class="fstat-no" title="function not covered">function stringifyRequest(options, body) {</span>
<span class="cstat-no" title="statement not covered">  var method = options.method || 'GET';</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  var port = options.port;</span>
<span class="cstat-no" title="statement not covered">  if (! port) <span class="cstat-no" title="statement not covered">port = (options.proto == 'https' ? '443' : '80');</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered">  if (options.proto == 'https' &amp;&amp; port == '443' ||</span>
      options.proto == 'http' &amp;&amp; port == '80') {
<span class="cstat-no" title="statement not covered">    port = '';</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered">  if (port) <span class="cstat-no" title="statement not covered">port = ':' + port;</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered">  var log = {</span>
    method: method,
    url: options.proto + '://' + options.hostname + port + options.path,
    headers: options.headers
  };
&nbsp;
<span class="cstat-no" title="statement not covered">  if (body) {</span>
<span class="cstat-no" title="statement not covered">    log.body = body;</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered">  return JSON.stringify(log, null, 2);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered">function isContentEncoded(headers) {</span>
<span class="cstat-no" title="statement not covered">  var contentEncoding = _.get(headers, 'content-encoding');</span>
<span class="cstat-no" title="statement not covered">  return _.isString(contentEncoding) &amp;&amp; contentEncoding !== '';</span>
}
&nbsp;
<span class="fstat-no" title="function not covered">function contentEncoding(headers, encoder) {</span>
<span class="cstat-no" title="statement not covered">  var contentEncoding = _.get(headers, 'content-encoding');</span>
<span class="cstat-no" title="statement not covered">  return contentEncoding === encoder;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered">function isJSONContent(headers) {</span>
<span class="cstat-no" title="statement not covered">  var contentType = _.get(headers, 'content-type');</span>
<span class="cstat-no" title="statement not covered">  if (Array.isArray(contentType)) {</span>
<span class="cstat-no" title="statement not covered">    contentType = contentType[0];</span>
  }
<span class="cstat-no" title="statement not covered">  contentType = (contentType || '').toLocaleLowerCase();</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  return contentType === 'application/json';</span>
}
&nbsp;
var headersFieldNamesToLowerCase = <span class="fstat-no" title="function not covered">function(headers) {</span>
<span class="cstat-no" title="statement not covered">  if(!_.isObject(headers)) {</span>
<span class="cstat-no" title="statement not covered">    return headers;</span>
  }
&nbsp;
  //  For each key in the headers, delete its value and reinsert it with lower-case key.
  //  Keys represent headers field names.
<span class="cstat-no" title="statement not covered">  var lowerCaseHeaders = {};</span>
<span class="cstat-no" title="statement not covered">  _.forOwn(headers, <span class="fstat-no" title="function not covered">function(fieldVal, fieldName) {</span></span>
<span class="cstat-no" title="statement not covered">    var lowerCaseFieldName = fieldName.toLowerCase();</span>
<span class="cstat-no" title="statement not covered">    if(!_.isUndefined(lowerCaseHeaders[lowerCaseFieldName])) {</span>
<span class="cstat-no" title="statement not covered">      throw new Error('Failed to convert header keys to lower case due to field name conflict: ' + lowerCaseFieldName);</span>
    }
<span class="cstat-no" title="statement not covered">    lowerCaseHeaders[lowerCaseFieldName] = fieldVal;</span>
  });
&nbsp;
<span class="cstat-no" title="statement not covered">  return lowerCaseHeaders;</span>
};
&nbsp;
var headersFieldsArrayToLowerCase = <span class="fstat-no" title="function not covered">function (headers) {</span>
<span class="cstat-no" title="statement not covered">  return _.uniq(_.map(headers, <span class="fstat-no" title="function not covered">function (fieldName) {</span></span>
<span class="cstat-no" title="statement not covered">    return fieldName.toLowerCase();</span>
  }));
};
&nbsp;
var headersArrayToObject = <span class="fstat-no" title="function not covered">function (rawHeaders) {</span>
<span class="cstat-no" title="statement not covered">  if(!_.isArray(rawHeaders)) {</span>
<span class="cstat-no" title="statement not covered">    return rawHeaders;</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered">  var headers = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  for (var i=0, len=rawHeaders.length; i&lt;len; i=i+2) {</span>
<span class="cstat-no" title="statement not covered">    var key = rawHeaders[i];</span>
<span class="cstat-no" title="statement not covered">    var value = rawHeaders[i+1];</span>
&nbsp;
<span class="cstat-no" title="statement not covered">    if (headers[key]) {</span>
<span class="cstat-no" title="statement not covered">      headers[key] = _.isArray(headers[key]) ? headers[key] : [headers[key]];</span>
<span class="cstat-no" title="statement not covered">      headers[key].push(value);</span>
    } else {
<span class="cstat-no" title="statement not covered">      headers[key] = value;</span>
    }
  }
&nbsp;
<span class="cstat-no" title="statement not covered">  return headers;</span>
};
&nbsp;
/**
 * Deletes the given `fieldName` property from `headers` object by performing
 * case-insensitive search through keys.
 *
 * @headers   {Object} headers - object of header field names and values
 * @fieldName {String} field name - string with the case-insensitive field name
 */
var deleteHeadersField = <span class="fstat-no" title="function not covered">function(headers, fieldNameToDelete) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  if(!_.isObject(headers) || !_.isString(fieldNameToDelete)) {</span>
<span class="cstat-no" title="statement not covered">    return;</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered">  var lowerCaseFieldNameToDelete = fieldNameToDelete.toLowerCase();</span>
&nbsp;
  //  Search through the headers and delete all values whose field name matches the given field name.
<span class="cstat-no" title="statement not covered">  _(headers).keys().each(<span class="fstat-no" title="function not covered">function(fieldName) {</span></span>
<span class="cstat-no" title="statement not covered">    var lowerCaseFieldName = fieldName.toLowerCase();</span>
<span class="cstat-no" title="statement not covered">    if(lowerCaseFieldName === lowerCaseFieldNameToDelete) {</span>
<span class="cstat-no" title="statement not covered">      delete headers[fieldName];</span>
      //  We don't stop here but continue in order to remove *all* matching field names
      //  (even though if seen regorously there shouldn't be any)
    }
  });
&nbsp;
};
&nbsp;
<span class="fstat-no" title="function not covered">function percentDecode (str) {</span>
<span class="cstat-no" title="statement not covered">  try {</span>
<span class="cstat-no" title="statement not covered">    return decodeURIComponent(str.replace(/\+/g, ' '));</span>
  } catch (e) {
<span class="cstat-no" title="statement not covered">    return str;</span>
  }
}
&nbsp;
<span class="fstat-no" title="function not covered">function percentEncode(str) {</span>
<span class="cstat-no" title="statement not covered">  return encodeURIComponent(str).replace(/[!'()*]/g, <span class="fstat-no" title="function not covered">function(c) {</span></span>
<span class="cstat-no" title="statement not covered">    return '%' + c.charCodeAt(0).toString(16).toUpperCase();</span>
  });
}
&nbsp;
<span class="fstat-no" title="function not covered">function matchStringOrRegexp(target, pattern) {</span>
<span class="cstat-no" title="statement not covered">  var str = target &amp;&amp; target.toString ? target.toString() : target;</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  return pattern instanceof RegExp  ? str.match(pattern) : str === pattern;</span>
}
&nbsp;
// return [newKey, newValue]
<span class="fstat-no" title="function not covered">function formatQueryValue(key, value, options) {</span>
<span class="cstat-no" title="statement not covered">  switch (true) {</span>
    case _.isNumber(value): // fall-though
    case _.isBoolean(value):
<span class="cstat-no" title="statement not covered">      value = value.toString();</span>
<span class="cstat-no" title="statement not covered">      break;</span>
    case _.isUndefined(value): // fall-though
    case _.isNull(value):
<span class="cstat-no" title="statement not covered">      value = '';</span>
<span class="cstat-no" title="statement not covered">      break;</span>
    case _.isString(value):
<span class="cstat-no" title="statement not covered">      if(options.encodedQueryParams) {</span>
<span class="cstat-no" title="statement not covered">        value = percentDecode(value);</span>
      }
<span class="cstat-no" title="statement not covered">      break;</span>
    case (value instanceof RegExp):
<span class="cstat-no" title="statement not covered">      break;</span>
    case _.isArray(value):
<span class="cstat-no" title="statement not covered">      var tmpArray = new Array(value.length);</span>
<span class="cstat-no" title="statement not covered">      for (var i = 0; i &lt; value.length; ++i) {</span>
<span class="cstat-no" title="statement not covered">        tmpArray[i] = formatQueryValue(i, value[i], options)[1];</span>
      }
<span class="cstat-no" title="statement not covered">      value = tmpArray;</span>
<span class="cstat-no" title="statement not covered">      break;</span>
    case _.isObject(value):
<span class="cstat-no" title="statement not covered">      var tmpObj = {};</span>
<span class="cstat-no" title="statement not covered">      _.forOwn(value, <span class="fstat-no" title="function not covered">function(subVal, subKey){</span></span>
<span class="cstat-no" title="statement not covered">        var subPair = formatQueryValue(subKey, subVal, options);</span>
<span class="cstat-no" title="statement not covered">        tmpObj[subPair[0]] = subPair[1];</span>
      });
<span class="cstat-no" title="statement not covered">      value = tmpObj;</span>
<span class="cstat-no" title="statement not covered">      break;</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered">  if (options.encodedQueryParams) <span class="cstat-no" title="statement not covered">key = percentDecode(key);</span></span>
<span class="cstat-no" title="statement not covered">  return [key, value];</span>
}
&nbsp;
<span class="fstat-no" title="function not covered">function isStream(obj) {</span>
<span class="cstat-no" title="statement not covered">  return obj &amp;&amp;</span>
      (typeof a !== 'string') &amp;&amp;
      (! Buffer.isBuffer(obj)) &amp;&amp;
      _.isFunction(obj.setEncoding);
}
&nbsp;
exports.normalizeRequestOptions = normalizeRequestOptions;
exports.isBinaryBuffer = isBinaryBuffer;
exports.mergeChunks = mergeChunks;
exports.overrideRequests = overrideRequests;
exports.restoreOverriddenRequests = restoreOverriddenRequests;
exports.stringifyRequest = stringifyRequest;
exports.isContentEncoded = isContentEncoded;
exports.contentEncoding = contentEncoding;
exports.isJSONContent = isJSONContent;
exports.headersFieldNamesToLowerCase = headersFieldNamesToLowerCase;
exports.headersFieldsArrayToLowerCase = headersFieldsArrayToLowerCase;
exports.headersArrayToObject = headersArrayToObject;
exports.deleteHeadersField = deleteHeadersField;
exports.percentEncode = percentEncode;
exports.percentDecode = percentDecode;
exports.matchStringOrRegexp = matchStringOrRegexp;
exports.formatQueryValue = formatQueryValue;
exports.isStream = isStream;
&nbsp;
&nbsp;</pre></td></tr>
</tbody></table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Sat Apr 15 2017 22:28:10 GMT+0000 (UTC)</div>
</div>


</body></html>